<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>InstaPlay Ultra ğŸ®</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin:0;
      font-family:"Tajawal",sans-serif;
      background:linear-gradient(-45deg,#f9ce34,#ee2a7b,#6228d7,#f9ce34);
      background-size:400% 400%;
      animation:gradientMove 12s ease infinite;
      color:white;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:70px 10px 70px 10px;
    }
    @keyframes gradientMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

    .header{position:fixed;top:0;left:0;right:0;height:60px;background:rgba(0,0,0,0.7);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:space-between;padding:0 15px;font-weight:bold;z-index:99;}
    .header .logo{font-size:18px;color:#f9ce34;}
    .header .balance{font-size:15px;}

    .card{background:rgba(0,0,0,0.6);padding:20px;border-radius:18px;width:100%;max-width:420px;box-shadow:0 10px 30px rgba(0,0,0,0.5);margin:10px auto;animation:fadeIn .6s ease;}
    h1,h2,h3{margin:0 0 15px;text-align:center;}

    input,button,select{width:100%;margin:6px 0;padding:12px;border:none;border-radius:10px;font-size:15px;}
    input,select{background:#fff;color:#333}
    button{cursor:pointer;font-weight:bold;background:white;color:#6228d7;transition:.3s}
    button:hover{background:#ee2a7b;color:white;transform:scale(1.05)}
    .hidden{display:none}

    .games-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}
    .game-btn{background:#fff;color:#6228d7;padding:14px;border-radius:10px;font-weight:bold;cursor:pointer;transition:.3s;text-align:center}
    .game-btn:hover{background:#f9ce34;color:#000;transform:scale(1.05)}

    table{width:100%;border-collapse:collapse;background:rgba(255,255,255,0.1);margin-top:10px;}
    th,td{padding:6px;border:1px solid rgba(255,255,255,0.2);font-size:13px;text-align:center}
    th{background:rgba(0,0,0,0.4)}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}

    /* Navbar */
    .navbar{position:fixed;bottom:0;left:0;right:0;background:rgba(0,0,0,0.7);display:flex;justify-content:space-around;padding:10px 0;backdrop-filter:blur(6px);z-index:99;}
    .nav-btn{color:#fff;text-align:center;flex:1;font-size:14px;cursor:pointer}
    .nav-btn:hover{color:#f9ce34}

    /* Confetti */
    .confetti{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:999;}

    @media (max-width:600px){
      .card{width:95%;padding:15px;}
      input,button,select{font-size:14px;padding:10px;}
      h1,h2,h3{font-size:18px;}
      .games-grid{grid-template-columns:1fr;}
    }
  </style>
</head>
<body>

<div class="header hidden" id="mainHeader">
  <div class="logo">ğŸ® InstaPlay</div>
  <div class="balance">ğŸ’° <span id="headerBalance">0</span>$</div>
</div>

<canvas class="confetti hidden" id="confettiCanvas"></canvas>

<!-- ğŸ” Auth -->
<div id="auth" class="card">
  <h1>ğŸ® InstaPlay Ultra</h1>
  <h3>Login / Register</h3>
  <input id="name" type="text" placeholder="Full name">
  <input id="email" type="text" placeholder="Email">
  <input id="pass" type="password" placeholder="Password">
  <button onclick="register()">Register</button>
  <button onclick="login()">Login</button>
  <button onclick="show('adminLogin')">ğŸ‘‘ Admin Login</button>
</div>

<!-- ğŸ‘‘ Admin Login -->
<div id="adminLogin" class="card hidden">
  <h2>ğŸ‘‘ Admin Login</h2>
  <input id="adminEmail" type="text" placeholder="Email">
  <input id="adminPass" type="password" placeholder="Password">
  <button onclick="adminLogin()">Login</button>
  <button onclick="backToAuth()">â¬…ï¸ Back</button>
</div>

<!-- ğŸ‘‘ Admin Panel -->
<div id="adminPanel" class="card hidden">
  <h2>ğŸ‘‘ Admin Panel</h2>
  <input id="searchId" type="text" placeholder="Search by ID">
  <button onclick="searchUserById()">ğŸ” Search</button>
  <div id="searchResult" style="margin:8px 0;font-size:14px"></div>
  <table id="usersTable">
    <thead><tr><th>Name</th><th>ID</th><th>Balance</th><th>Edit Balance</th><th>Mode</th></tr></thead>
    <tbody></tbody>
  </table>
  <button onclick="backToAuth()">â¬…ï¸ Logout</button>
</div>

<!-- ğŸ® Dashboard -->
<div id="dashboard" class="card hidden">
  <h2>Welcome <span id="userName"></span></h2>
  <p>ID: <span id="userId"></span></p>
  <select id="betAmount">
    <option value="5">5$</option>
    <option value="10">10$</option>
    <option value="20">20$</option>
    <option value="50">50$</option>
  </select>
  <button onclick="claimBonus()">ğŸ Claim Daily Bonus</button>
  <div class="games-grid">
    <div class="game-btn" onclick="hideAll();show('coinGame')">ğŸª™ Coin</div>
    <div class="game-btn" onclick="hideAll();show('diceGame')">ğŸ² Dice</div>
    <div class="game-btn" onclick="hideAll();show('rpsGame')">âœŠâœ‹âœŒï¸ RPS</div>
    <div class="game-btn" onclick="hideAll();show('slotGame')">ğŸ° Slot</div>
    <div class="game-btn" onclick="startMines()">ğŸ’£ Mines</div>
    <div class="game-btn" onclick="hideAll();show('crashGame')">ğŸ¢ Crash</div>
    <div class="game-btn" onclick="hideAll();show('wheelGame')">ğŸ¡ Wheel</div>
    <div class="game-btn" onclick="hideAll();show('plinkoGame')">ğŸŸ¢ Plinko</div>
    <div class="game-btn" onclick="hideAll();show('towerGame')">ğŸ° Tower</div>
  </div>
  <button onclick="hideAll();show('bankCard')">ğŸ¦ Deposit / Withdraw</button>
  <button onclick="show('historyCard');renderHistory()">ğŸ“œ Transactions</button>
  <button onclick="logout()">ğŸšª Logout</button>
</div>

<!-- ğŸ“œ Transactions -->
<div id="historyCard" class="card hidden">
  <h2>ğŸ“œ Transactions</h2>
  <table id="historyTable"><thead><tr><th>Type</th><th>Amount</th><th>Date</th></tr></thead><tbody></tbody></table>
  <button onclick="backToDash()">â¬…ï¸ Back</button>
</div>

<!-- ğŸ¦ Banks -->
<div id="bankCard" class="card hidden">
  <h2>ğŸ¦ Deposit / Withdraw</h2>
  <ul style="list-style:none;padding:0;text-align:center">
    <li>ğŸ’³ Cash Plus</li>
    <li>ğŸ¦ CIH Bank</li>
    <li>ğŸ¦ Al Barid Bank</li>
    <li>ğŸ¦ Attijariwafa Bank</li>
  </ul>
  <p>ğŸ“ WhatsApp:<br><b style="color:#0f0">+212 713-041921</b></p>
  <button onclick="backToDash()">â¬…ï¸ Back</button>
</div>

<!-- ğŸ® Games Sections -->
<div id="coinGame" class="card hidden"><h2>ğŸª™ Coin Toss</h2><button onclick="flipCoin('Heads')">Heads</button><button onclick="flipCoin('Tails')">Tails</button><p id="coinResult"></p><button onclick="backToDash()">â¬…ï¸ Back</button></div>
<div id="diceGame" class="card hidden"><h2>ğŸ² Dice</h2><button onclick="rollDice()">ğŸ² Roll</button><p id="diceResult"></p><button onclick="backToDash()">â¬…ï¸ Back</button></div>
<div id="rpsGame" class="card hidden"><h2>âœŠâœ‹âœŒï¸ RPS</h2><button onclick="playRPS('âœŠ')">âœŠ</button><button onclick="playRPS('âœ‹')">âœ‹</button><button onclick="playRPS('âœŒï¸')">âœŒï¸</button><p>Ø§Ù†Øª: <span id="playerChoice"></span></p><p>Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±: <span id="computerChoice"></span></p><p id="rpsResult"></p><button onclick="backToDash()">â¬…ï¸ Back</button></div>
<div id="slotGame" class="card hidden"><h2>ğŸ° Slot</h2><button onclick="playSlot()">â–¶ï¸ Spin</button><p id="slotResult"></p><button onclick="backToDash()">â¬…ï¸ Back</button></div>
<div id="minesGame" class="card hidden"><h2>ğŸ’£ Mines</h2><div id="minesGrid" style="display:grid;grid-template-columns:repeat(5,60px);gap:10px;justify-content:center;margin:15px 0;"></div><p id="minesResult"></p><button onclick="cashoutMines()">ğŸ’µ Cashout</button><button onclick="resetMines()">ğŸ”„ Reset</button><button onclick="backToDash()">â¬…ï¸ Back</button></div>
<div id="crashGame" class="card hidden"><h2>ğŸ¢ Crash</h2><p id="crashMultiplier">Multiplier: x1.00</p><button onclick="startCrash()">â–¶ï¸ Start</button><button onclick="cashoutCrash()">ğŸ’µ Cashout</button><p id="crashResult"></p><button onclick="backToDash()">â¬…ï¸ Back</button></div>
<div id="wheelGame" class="card hidden"><h2>ğŸ¡ Wheel</h2><button onclick="spinWheel()">â–¶ï¸ Spin</button><p id="wheelResult"></p><button onclick="backToDash()">â¬…ï¸ Back</button></div>
<div id="plinkoGame" class="card hidden"><h2>ğŸŸ¢ Plinko</h2><button onclick="playPlinko()">â–¶ï¸ Drop Ball</button><p id="plinkoResult"></p><button onclick="backToDash()">â¬…ï¸ Back</button></div>
<div id="towerGame" class="card hidden"><h2>ğŸ° Tower</h2><button onclick="startTower()">â–¶ï¸ Start</button><button onclick="nextTower()">â¬†ï¸ Next Level</button><button onclick="cashoutTower()">ğŸ’µ Cashout</button><p id="towerResult"></p><button onclick="backToDash()">â¬…ï¸ Back</button></div>

<!-- Navbar -->
<div class="navbar hidden" id="navbar">
  <div class="nav-btn" onclick="hideAll();show('dashboard')">ğŸ  Home</div>
  <div class="nav-btn" onclick="hideAll();show('dashboard')">ğŸ® Games</div>
  <div class="nav-btn" onclick="hideAll();show('bankCard')">ğŸ’° Wallet</div>
  <div class="nav-btn" onclick="hideAll();show('historyCard');renderHistory()">ğŸ“œ History</div>
</div>

<!-- ğŸŸ¢ JS Ù‡Ù†Ø§ ØºØ§Ø¯ÙŠ Ù†Ø²ÙŠØ¯ÙˆÙ‡ ÙÙ€ Ø§Ù„Ø¬Ø²Ø¡ 2 -->
<script src="script.js"></script>
</body>
</html>
/* =================== Config =================== */
const ADMIN_EMAIL="special@gmail.com";
const ADMIN_PASS="special123";
let currentUser=null;

/* =================== Sounds =================== */
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
function playTone(freq,duration,type="sine"){
  let o=audioCtx.createOscillator();
  let g=audioCtx.createGain();
  o.type=type;
  o.frequency.setValueAtTime(freq,audioCtx.currentTime);
  o.connect(g);g.connect(audioCtx.destination);
  o.start();
  g.gain.exponentialRampToValueAtTime(0.0001,audioCtx.currentTime+duration/1000);
  o.stop(audioCtx.currentTime+duration/1000);
}
function soundClick(){playTone(500,100,"square");}
function soundWin(){playTone(600,200,"sine");setTimeout(()=>playTone(800,200,"sine"),200);}
function soundLose(){playTone(400,300,"sawtooth");}

/* =================== Confetti =================== */
function launchConfetti(){
  let canvas=document.getElementById("confettiCanvas");
  canvas.classList.remove("hidden");
  let ctx=canvas.getContext("2d");
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
  let pieces=new Array(120).fill().map(()=>({
    x:Math.random()*canvas.width,
    y:Math.random()*canvas.height,
    r:Math.random()*6+4,
    d:Math.random()*100,
    color:`hsl(${Math.random()*360},100%,50%)`
  }));
  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    pieces.forEach(p=>{
      ctx.beginPath();
      ctx.fillStyle=p.color;
      ctx.arc(p.x,p.y,p.r,0,Math.PI*2,false);
      ctx.fill();
    });
    update();
  }
  function update(){
    pieces.forEach(p=>{
      p.y+=2;
      if(p.y>canvas.height){
        p.x=Math.random()*canvas.width;
        p.y=-10;
      }
    });
  }
  let interval=setInterval(draw,20);
  setTimeout(()=>{clearInterval(interval);canvas.classList.add("hidden");},3000);
}

/* =================== Helpers =================== */
function uid(){return "UID"+Math.floor(Math.random()*99999);}
function saveUser(u){localStorage.setItem("user_"+u.email,JSON.stringify(u));renderUsers();}
function loadUser(e){return JSON.parse(localStorage.getItem("user_"+e));}
function allUsers(){
  let arr=[];
  for(let i=0;i<localStorage.length;i++){
    let k=localStorage.key(i);
    if(k.startsWith("user_"))arr.push(JSON.parse(localStorage.getItem(k)));
  }
  return arr;
}
function hideAll(){document.querySelectorAll(".card").forEach(c=>c.classList.add("hidden"));}
function show(id){
  hideAll();
  document.getElementById(id).classList.remove("hidden");
  document.getElementById("mainHeader").classList.remove("hidden");
  document.getElementById("navbar").classList.remove("hidden");
}
function backToDash(){hideAll();show("dashboard");}
function backToAuth(){
  hideAll();
  document.getElementById("auth").classList.remove("hidden");
  document.getElementById("mainHeader").classList.add("hidden");
  document.getElementById("navbar").classList.add("hidden");
}

/* =================== Auth =================== */
function register(){
  let name=document.getElementById("name").value;
  let email=document.getElementById("email").value;
  let pass=document.getElementById("pass").value;
  if(!name||!email||!pass){alert("Fill all fields");return;}
  if(loadUser(email)){alert("Account already exists");return;}
  let u={name,email,password:pass,balance:20,id:uid(),mode:"normal",lastBonus:""};
  saveUser(u);
  alert("Registered successfully (20$ bonus).");
  renderUsers();
}
function login(){
  let email=document.getElementById("email").value;
  let pass=document.getElementById("pass").value;
  let u=loadUser(email);
  if(!u||u.password!==pass){alert("Invalid credentials");return;}
  currentUser=u;
  updateUI();
  show("dashboard");
}
function logout(){currentUser=null;backToAuth();}
function adminLogin(){
  let email=document.getElementById("adminEmail").value;
  let pass=document.getElementById("adminPass").value;
  if(email===ADMIN_EMAIL && pass===ADMIN_PASS){
    show("adminPanel");renderUsers();
  }else alert("âŒ Wrong admin login");
}
function updateUI(){
  if(!currentUser)return;
  document.getElementById("userName").innerText=currentUser.name;
  document.getElementById("userId").innerText=currentUser.id;
  document.getElementById("balance").innerText=currentUser.balance;
  document.getElementById("headerBalance").innerText=currentUser.balance;
  saveUser(currentUser);
}
function getBet(){
  let v=parseInt(document.getElementById("betAmount").value);
  if(currentUser.balance<v){alert("Not enough balance");return null;}
  return v;
}
function forceResult(){return currentUser.mode||"normal";}

/* =================== Admin Panel =================== */
function renderUsers(){
  let tbody=document.querySelector("#usersTable tbody");
  tbody.innerHTML="";
  allUsers().forEach(u=>{
    let safeId=btoa(u.email);
    let tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${u.name}</td>
      <td>${u.id}</td>
      <td>${u.balance}</td>
      <td><input type='number' value='${u.balance}' id='bal_${safeId}'><button onclick="updateBal('${u.email}')">âœ”ï¸</button></td>
      <td><select id="mode_${safeId}" onchange="changeMode('${u.email}')">
        <option value="normal" ${u.mode==="normal"?"selected":""}>âš–ï¸ Normal</option>
        <option value="win" ${u.mode==="win"?"selected":""}>ğŸ”¥ Always Win</option>
        <option value="lose" ${u.mode==="lose"?"selected":""}>âŒ Always Lose</option>
      </select></td>`;
    tbody.appendChild(tr);
  });
}
function updateBal(email){
  let safeId=btoa(email);
  let u=loadUser(email);
  u.balance=parseInt(document.getElementById("bal_"+safeId).value);
  saveUser(u);
  if(currentUser && currentUser.email===email){currentUser=u;updateUI();}
  renderUsers();
}
function changeMode(email){
  let safeId=btoa(email);
  let u=loadUser(email);
  u.mode=document.getElementById("mode_"+safeId).value;
  saveUser(u);
  if(currentUser && currentUser.email===email){currentUser=u;}
  renderUsers();
}
function searchUserById(){
  let id=document.getElementById("searchId").value.trim();
  let users=allUsers();
  let found=users.find(u=>u.id===id);
  let div=document.getElementById("searchResult");
  if(found){
    div.innerHTML=`<p>ğŸ‘¤ <b>${found.name}</b><br>ğŸ†” ${found.id}<br>ğŸ’° ${found.balance}$</p>`;
  }else{div.innerHTML="<p>âŒ No user found</p>";}
}

/* =================== Bonus =================== */
function claimBonus(){
  let today=new Date().toDateString();
  if(currentUser.lastBonus===today){
    alert("You already claimed your daily bonus!");
    return;
  }
  let bonus=5;
  currentUser.balance+=bonus;
  currentUser.lastBonus=today;
  updateUI();
  addHistory("Bonus",bonus);
  alert("ğŸ Daily bonus +5$ added!");
  launchConfetti();
}

/* =================== Transactions =================== */
function addHistory(type,amount){
  let h=JSON.parse(localStorage.getItem("history_"+currentUser.email)||"[]");
  h.push({type,amount,date:new Date().toLocaleString()});
  localStorage.setItem("history_"+currentUser.email,JSON.stringify(h));
}
function renderHistory(){
  let tbody=document.querySelector("#historyTable tbody");
  tbody.innerHTML="";
  let h=JSON.parse(localStorage.getItem("history_"+currentUser.email)||"[]");
  h.forEach(op=>{
    let tr=document.createElement("tr");
    tr.innerHTML=`<td>${op.type}</td><td>${op.amount}$</td><td>${op.date}</td>`;
    tbody.appendChild(tr);
  });
}

/* =================== Games =================== */
// Coin
function flipCoin(choice){
  let bet=getBet();if(!bet)return;soundClick();
  let mode=forceResult();let result;
  if(mode==="win"){result=choice;}
  else if(mode==="lose"){result=(choice==="Heads"?"Tails":"Heads");}
  else{result=Math.random()<0.5?"Heads":"Tails";}
  setTimeout(()=>{
    if(result===choice){
      currentUser.balance+=bet;
      document.getElementById("coinResult").innerText="ğŸ‰ Win +"+bet;
      soundWin();launchConfetti();addHistory("Win",bet);
    }else{
      currentUser.balance-=bet;
      document.getElementById("coinResult").innerText="âŒ Lose -"+bet;
      soundLose();addHistory("Lose",bet);
    }
    updateUI();
  },800);
}

// Dice
function rollDice(){
  let bet=getBet();if(!bet)return;soundClick();
  let mode=forceResult();let r;
  if(mode==="win"){r=6;}
  else if(mode==="lose"){r=1;}
  else{r=Math.floor(Math.random()*6)+1;}
  let faces=["âš€","âš","âš‚","âšƒ","âš„","âš…"];
  setTimeout(()=>{
    if(r>=4){
      currentUser.balance+=bet;
      document.getElementById("diceResult").innerText=`${faces[r-1]} ğŸ‰ Win +${bet}`;
      soundWin();launchConfetti();addHistory("Win",bet);
    }else{
      currentUser.balance-=bet;
      document.getElementById("diceResult").innerText=`${faces[r-1]} âŒ Lose -${bet}`;
      soundLose();addHistory("Lose",bet);
    }
    updateUI();
  },800);
}

// RPS
function playRPS(player){
  let bet=getBet();if(!bet)return;soundClick();
  let mode=forceResult();let options=["âœŠ","âœ‹","âœŒï¸"];let comp;
  if(mode==="win"){comp=(player==="âœŠ"?"âœŒï¸":player==="âœ‹"?"âœŠ":"âœ‹");}
  else if(mode==="lose"){comp=(player==="âœŠ"?"âœ‹":player==="âœ‹"?"âœŒï¸":"âœŠ");}
  else{comp=options[Math.floor(Math.random()*3)];}
  document.getElementById("playerChoice").innerText=player;
  document.getElementById("computerChoice").innerText=comp;
  let result="";
  if(player===comp){result="ğŸ¤ Draw";addHistory("Draw",0);}
  else if((player==="âœŠ"&&comp==="âœŒï¸")||(player==="âœ‹"&&comp==="âœŠ")||(player==="âœŒï¸"&&comp==="âœ‹")){
    currentUser.balance+=bet;result="ğŸ‰ Win +"+bet;soundWin();launchConfetti();addHistory("Win",bet);
  }else{currentUser.balance-=bet;result="âŒ Lose -"+bet;soundLose();addHistory("Lose",bet);}
  document.getElementById("rpsResult").innerText=result;updateUI();
}

// Slot
function playSlot(){
  let bet=getBet();if(!bet)return;soundClick();
  let mode=forceResult();let s=["ğŸ’","ğŸ‹","â­","ğŸ””","7ï¸âƒ£"];let r;
  if(mode==="win"){r=["7ï¸âƒ£","7ï¸âƒ£","7ï¸âƒ£"];}
  else if(mode==="lose"){r=["ğŸ’","â­","ğŸ””"];}
  else{r=[s[Math.floor(Math.random()*s.length)],s[Math.floor(Math.random()*s.length)],s[Math.floor(Math.random()*s.length)]];}
  let msg="";
  if(r[0]===r[1]&&r[1]===r[2]){
    currentUser.balance+=bet*5;
    msg="ğŸ‰ Jackpot!! +"+(bet*5);soundWin();launchConfetti();addHistory("Jackpot",bet*5);
  }else if(r[0]===r[1]||r[1]===r[2]||r[0]===r[2]){
    currentUser.balance+=bet;msg="âœ¨ Small Win +"+bet;soundWin();addHistory("Win",bet);
  }else{currentUser.balance-=bet;msg="âŒ Lose -"+bet;soundLose();addHistory("Lose",bet);}
  document.getElementById("slotResult").innerText=r.join(" ")+" â†’ "+msg;updateUI();
}

// Mines
let minesData=[];let minesActive=false;let minesBet=0;
function startMines(){hideAll();show("minesGame");resetMines();}
function resetMines(){
  let g=document.getElementById("minesGrid");
  g.innerHTML="";minesData=[];minesActive=true;minesBet=getBet();if(!minesBet)return;
  for(let i=0;i<25;i++){
    let mine=Math.random()<0.2;minesData.push(mine);
    let b=document.createElement("button");
    b.innerText="â“";b.style.width="60px";b.style.height="60px";b.style.fontSize="22px";
    b.onclick=()=>clickMine(i,b);g.appendChild(b);
  }
}
function clickMine(i,btn){
  if(!minesActive)return;soundClick();
  if(minesData[i]){
    btn.innerText="ğŸ’£";btn.style.background="#ff4444";
    currentUser.balance-=minesBet;minesActive=false;
    document.getElementById("minesResult").innerText="âŒ Boom! -"+minesBet;
    soundLose();addHistory("Lose",minesBet);
  }else{
    btn.innerText="ğŸ’";btn.style.background="#44ff44";
    currentUser.balance+=minesBet;
    document.getElementById("minesResult").innerText="ğŸ‰ Safe! +"+minesBet;
    soundWin();launchConfetti();addHistory("Win",minesBet);
  }
  updateUI();
}
function cashoutMines(){if(minesActive){minesActive=false;document.getElementById("minesResult").innerText+=" ğŸ’µ Cashed Out";}}

// Crash
let crashActive=false;let crashInterval;let crashMultiplier=1;let crashBet=0;
function startCrash(){
  crashBet=getBet();if(!crashBet)return;
  crashActive=true;crashMultiplier=1;
  document.getElementById("crashResult").innerText="";
  clearInterval(crashInterval);
  crashInterval=setInterval(()=>{
    if(!crashActive)return;
    crashMultiplier+=(Math.random()*0.2);
    document.getElementById("crashMultiplier").innerText="Multiplier: x"+crashMultiplier.toFixed(2);
    if(Math.random()<0.05){
      crashActive=false;clearInterval(crashInterval);
      currentUser.balance-=crashBet;
      document.getElementById("crashResult").innerText="ğŸ’¥ Crash! -"+crashBet;
      soundLose();addHistory("Lose",crashBet);updateUI();
    }
  },500);
}
function cashoutCrash(){
  if(crashActive){
    crashActive=false;clearInterval(crashInterval);
    let profit=Math.floor(crashBet*crashMultiplier);
    currentUser.balance+=profit;
    document.getElementById("crashResult").innerText="ğŸ’µ Cashed Out +"+profit;
    soundWin();launchConfetti();addHistory("Win",profit);updateUI();
  }
}

// Wheel
function spinWheel(){
  let bet=getBet();if(!bet)return;soundClick();
  let prizes=[0,bet,bet*2,bet*5,bet*10];
  let result=prizes[Math.floor(Math.random()*prizes.length)];
  if(result>0){
    currentUser.balance+=result;
    document.getElementById("wheelResult").innerText="ğŸ‰ You won +"+result;
    soundWin();launchConfetti();addHistory("Win",result);
  }else{
    currentUser.balance-=bet;
    document.getElementById("wheelResult").innerText="âŒ Lose -"+bet;
    soundLose();addHistory("Lose",bet);
  }
  updateUI();
}

// Plinko
function playPlinko(){
  let bet=getBet();if(!bet)return;
  let slots=[0,bet,bet*2,bet*3,bet*5];
  let result=slots[Math.floor(Math.random()*slots.length)];
  if(result>0){
    currentUser.balance+=result;
    document.getElementById("plinkoResult").innerText="ğŸŸ¢ Plinko Win +"+result;
    soundWin();launchConfetti();addHistory("Win",result);
  }else{
    currentUser.balance-=bet;
    document.getElementById("plinkoResult").innerText="âŒ Plinko Lose -"+bet;
    soundLose();addHistory("Lose",bet);
  }
  updateUI();
}

// Tower
let towerLevel=0;let towerBet=0;let towerActive=false;
function startTower(){
  towerBet=getBet();if(!towerBet)return;
  towerLevel=0;towerActive=true;
  document.getElementById("towerResult").innerText="Game Started!";
}
function nextTower(){
  if(!towerActive)return;
  let win=Math.random()<0.7;
  if(win){
    towerLevel++;
    let reward=towerBet*Math.pow(2,towerLevel);
    document.getElementById("towerResult").innerText="ğŸ° Level "+towerLevel+" â†’ Potential: +"+reward;
  }else{
    towerActive=false;
    currentUser.balance-=towerBet;
    document.getElementById("towerResult").innerText="âŒ Tower collapsed -"+towerBet;
    soundLose();addHistory("Lose",towerBet);updateUI();
  }
}
function cashoutTower(){
  if(towerActive){
    let reward=towerBet*Math.pow(2,towerLevel);
    currentUser.balance+=reward;
    document.getElementById("towerResult").innerText="ğŸ’µ Cashed Out +"+reward;
    towerActive=false;soundWin();launchConfetti();addHistory("Win",reward);updateUI();
  }
}
