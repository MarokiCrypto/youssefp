<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>InstaPlay 🎮</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body{
      margin:0;
      font-family:"Tajawal",sans-serif;
      background:linear-gradient(-45deg,#f9ce34,#ee2a7b,#6228d7,#f9ce34);
      background-size:400% 400%;
      animation:gradientMove 12s ease infinite;
      color:white;
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      padding:20px;
    }
    @keyframes gradientMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    .card{
      background:rgba(0,0,0,0.6);
      padding:20px;
      border-radius:18px;
      width:100%;
      max-width:400px;
      box-shadow:0 10px 30px rgba(0,0,0,0.5);
      margin:10px auto;
      animation:fadeIn .6s ease;
    }
    h1,h2,h3{margin:0 0 15px;text-align:center;}
    input,button,select{width:100%;margin:6px 0;padding:12px;border:none;border-radius:10px;font-size:15px;}
    input,select{background:#fff;color:#333}
    button{cursor:pointer;font-weight:bold;background:white;color:#6228d7;transition:.3s}
    button:hover{background:#ee2a7b;color:white;transform:scale(1.05)}
    .hidden{display:none}
    table{width:100%;border-collapse:collapse;background:rgba(255,255,255,0.1);margin-top:10px;}
    th,td{padding:6px;border:1px solid rgba(255,255,255,0.2);font-size:13px;text-align:center}
    th{background:rgba(0,0,0,0.4)}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
    @media (max-width:600px){
      .card{width:100%;padding:15px;margin:0;}
      input,button,select{font-size:14px;padding:10px;}
      h1,h2,h3{font-size:16px;}
      table{font-size:11px;}
    }
  </style>
</head>
<body>

<!-- 🔐 Auth -->
<div id="auth" class="card">
  <h1>🎮 InstaPlay</h1>
  <h3>Login / Register</h3>
  <input id="name" type="text" placeholder="Full name">
  <input id="email" type="text" placeholder="Email">
  <input id="pass" type="password" placeholder="Password">
  <button onclick="register()">Register</button>
  <button onclick="login()">Login</button>
  <button onclick="show('adminLogin')">👑 Admin Login</button>
</div>

<!-- 👑 Admin Login -->
<div id="adminLogin" class="card hidden">
  <h2>👑 Admin Login</h2>
  <input id="adminEmail" type="text" placeholder="Email">
  <input id="adminPass" type="password" placeholder="Password">
  <button onclick="adminLogin()">Login</button>
  <button onclick="backToAuth()">⬅️ Back</button>
</div>

<!-- 👑 Admin Panel -->
<div id="adminPanel" class="card hidden">
  <h2>👑 Admin Panel</h2>
  <input id="searchId" type="text" placeholder="Search by ID">
  <button onclick="searchUserById()">🔍 Search</button>
  <div id="searchResult" style="margin:8px 0;font-size:14px"></div>
  <table id="usersTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>ID</th>
        <th>Balance</th>
        <th>Edit Balance</th>
        <th>Mode</th>
        <th>Last Seen</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <button onclick="backToAuth()">⬅️ Logout</button>
</div>

<!-- 🎮 Dashboard -->
<div id="dashboard" class="card hidden">
  <h2>Welcome <span id="userName"></span></h2>
  <p>ID: <span id="userId"></span></p>
  <p>💰 Balance: <span id="balance"></span> $</p>
  <select id="betAmount">
    <option value="5">5$</option>
    <option value="10">10$</option>
    <option value="20">20$</option>
    <option value="50">50$</option>
  </select>
  <button onclick="logout()">🚪 Logout</button>
</div>

<script>
const ADMIN_EMAIL="special@gmail.com";
const ADMIN_PASS="special123";
let currentUser=null;

/* ==================== Reset Accounts ==================== */
function resetAccounts(){
  // نخلي vap1 فقط إذا ماكانش مسجل
  if(!loadUser("vap1@test.com")){
    localStorage.clear();
    let demo={
      name:"vap1",
      email:"vap1@test.com",
      password:"1234",
      balance:100,
      id:"UID1",
      mode:"normal",
      lastSeen:new Date().toLocaleString(),
      isNew:false
    };
    saveUser(demo);
  }
}
resetAccounts();

/* Helpers */
function uid(){return "UID"+Math.floor(Math.random()*99999);}
function saveUser(u){localStorage.setItem("user_"+u.email,JSON.stringify(u));}
function loadUser(e){return JSON.parse(localStorage.getItem("user_"+e));}
function allUsers(){let arr=[];for(let i=0;i<localStorage.length;i++){let k=localStorage.key(i);if(k.startsWith("user_"))arr.push(JSON.parse(localStorage.getItem(k)));}return arr;}
function hideAll(){document.querySelectorAll(".card").forEach(c=>c.classList.add("hidden"));}
function show(id){hideAll();document.getElementById(id).classList.remove("hidden");}
function backToAuth(){hideAll();show("auth");}

/* Auth */
function register(){
  let name=document.getElementById("name").value;
  let email=document.getElementById("email").value;
  let pass=document.getElementById("pass").value;
  if(!name||!email||!pass){alert("Fill all fields");return;}
  if(loadUser(email)){alert("Account already exists");return;}
  let u={name,email,password:pass,balance:20,id:uid(),mode:"normal",lastSeen:new Date().toLocaleString(),isNew:true};
  saveUser(u);alert("Registered successfully (20$ bonus).");renderUsers();
}
function login(){
  let email=document.getElementById("email").value;
  let pass=document.getElementById("pass").value;
  let u=loadUser(email);
  if(!u||u.password!==pass){alert("Invalid credentials");return;}
  currentUser=u;
  trackActivity(currentUser);
  updateUI();show("dashboard");
}
function logout(){currentUser=null;backToAuth();}
function adminLogin(){
  let email=document.getElementById("adminEmail").value;
  let pass=document.getElementById("adminPass").value;
  if(email===ADMIN_EMAIL && pass===ADMIN_PASS){show("adminPanel");renderUsers();}
  else alert("❌ Wrong admin login");
}
function updateUI(){
  document.getElementById("userName").innerText=currentUser.name;
  document.getElementById("userId").innerText=currentUser.id;
  document.getElementById("balance").innerText=currentUser.balance;
  saveUser(currentUser);
}

/* Admin Panel */
function renderUsers(){
  let tbody=document.querySelector("#usersTable tbody");if(!tbody)return;
  tbody.innerHTML="";
  allUsers().forEach(u=>{
    let tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${u.name} ${u.isNew?"<span style='color:lime;font-weight:bold'>🆕</span>":""}</td>
      <td>${u.id}</td>
      <td style="color:${u.balance>=0?"#0f0":"#f44"}">${u.balance}</td>
      <td><input type='number' value='${u.balance}' id='bal_${u.email}' style="width:70px"><button onclick="updateBal('${u.email}')">✔️</button></td>
      <td><select id="mode_${u.email}" onchange="changeMode('${u.email}')">
        <option value="normal" ${u.mode==="normal"?"selected":""}>⚖️ Normal</option>
        <option value="win" ${u.mode==="win"?"selected":""}>🔥 Always Win</option>
        <option value="lose" ${u.mode==="lose"?"selected":""}>❌ Always Lose</option>
      </select></td>
      <td>${u.lastSeen||"—"}</td>`;
    tbody.appendChild(tr);
  });
}
setInterval(renderUsers,2000);

/* Search */
function searchUserById(){
  let id=document.getElementById("searchId")?.value.trim();
  if(!id)return;
  let users=allUsers();
  let found=users.find(u=>u.id===id);
  let div=document.getElementById("searchResult");
  if(found){
    div.innerHTML=`<p>👤 <b>${found.name}</b><br>🆔 ${found.id}<br>💰 ${found.balance}$<br>🕒 ${found.lastSeen||"N/A"}</p>`;
  }else{
    div.innerHTML="<p>❌ No user found</p>";
  }
}

/* Update Bal/Mode */
function updateBal(email){
  let u=loadUser(email);
  u.balance=parseInt(document.getElementById("bal_"+email).value);
  saveUser(u);renderUsers();
}
function changeMode(email){
  let u=loadUser(email);
  u.mode=document.getElementById("mode_"+email).value;
  saveUser(u);renderUsers();
}

/* Track Activity */
function trackActivity(user){
  user.lastSeen=new Date().toLocaleString();
  user.isNew=false;
  saveUser(user);
}
</script>
</body>
</html>
