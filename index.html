<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>🤣 تصويت صحابنا 🤣</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      color: #fff;
      background: linear-gradient(-45deg,#f9ce34,#ee2a7b,#6228d7,#f9ce34);
      background-size: 400% 400%;
      animation: gradientMove 10s ease infinite;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      flex-direction: column;
      overflow-x: hidden;
    }
    @keyframes gradientMove {
      0% {background-position:0% 50%}
      50% {background-position:100% 50%}
      100% {background-position:0% 50%}
    }
    header {
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 20px;
      text-shadow: 0 0 8px #fff, 0 0 15px #ff00ff, 0 0 25px #00f;
    }
    .card {
      background: rgba(0,0,0,0.6);
      border-radius: 16px;
      padding: 20px;
      width: 95%;
      max-width: 420px;
      text-align: center;
      box-shadow: 0 0 15px rgba(0,0,0,0.6),0 0 25px #ff00ff;
      animation: fadeIn 0.6s ease;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(30px);}
      to {opacity: 1; transform: translateY(0);}
    }
    .card h3 {
      margin-bottom: 15px;
      font-size: 22px;
      text-shadow: 0 0 6px #ff0,0 0 10px #0ff;
    }
    button {
      display: block;
      width: 100%;
      margin: 6px 0;
      padding: 12px;
      background: #222;
      border: 1px solid #ff00ff;
      border-radius: 10px;
      color: #fff;
      font-size: 18px;
      cursor: pointer;
      transition: 0.3s;
      position: relative;
      overflow: hidden;
    }
    button:hover {
      background: #ff00ff;
      color: #fff;
      box-shadow: 0 0 12px #ff00ff,0 0 20px #0ff;
    }
    .emoji-fly {
      position: absolute;
      animation: fly 1s forwards;
      font-size: 26px;
      pointer-events: none;
    }
    @keyframes fly {
      0% {opacity:1; transform:translateY(0) scale(1);}
      100% {opacity:0; transform:translateY(-60px) scale(1.5);}
    }
    .controls {
      margin-top: 15px;
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }
    .leaderboard {
      background: rgba(0,0,0,0.7);
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 0 15px #0ff, 0 0 25px #f0f;
      text-align: center;
      width: 95%;
      max-width: 420px;
    }
    .leaderboard h2 {
      margin-bottom: 15px;
      font-size: 24px;
    }
    .progress {
      background: #444;
      border-radius: 8px;
      height: 22px;
      margin: 5px 0;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      text-align: center;
      line-height: 22px;
      color: #fff;
      font-size: 13px;
      transition: width 0.5s;
    }
    .gold {color: gold; font-weight: bold;}
    .silver {color: silver; font-weight: bold;}
    .bronze {color: #cd7f32; font-weight: bold;}
  </style>
</head>
<body>

<header>🤣 تصويت على صحابنا 🤣</header>
<div class="card" id="questionCard">
  <h3 id="question"></h3>
  <div id="options"></div>
  <div class="controls">
    <button onclick="prevQuestion()">⬅️ السابق</button>
    <button onclick="nextQuestion()">التالي ➡️</button>
  </div>
  <button onclick="randomVote()">🎲 Surprise Me 😂</button>
</div>

<div class="leaderboard" id="leaderboard" style="display:none;">
  <h2>🏆 الترتيب النهائي 🏆</h2>
  <div id="results"></div>
</div>

<!-- أصوات -->
<audio id="laugh1" src="https://www.myinstants.com/media/sounds/cartoon-laugh.mp3"></audio>
<audio id="laugh2" src="https://www.myinstants.com/media/sounds/laugh.mp3"></audio>
<audio id="laugh3" src="https://www.myinstants.com/media/sounds/trollolol.mp3"></audio>

<script>
  const names = ["Bilal","Youssef","Adam","Mahmod","Khalid","Ayman"];
  const categories = [
    "زامل لكبير 😂","لعندو طرمة 🤕","لكيتعطل 🐌","لفه سلوكية 🤡","لكيطير 🕊️","ضحكي 🤣","طنيزي 😜"
  ];
  let votes = JSON.parse(localStorage.getItem("votes2077")) || {};
  let current = 0;

  function renderQuestion() {
    if(current >= categories.length) {showLeaderboard(); return;}
    document.getElementById("question").textContent = categories[current];
    const options = document.getElementById("options");
    options.innerHTML = "";
    names.forEach(n=>{
      if(!votes[categories[current]]) votes[categories[current]]={};
      if(!votes[categories[current]][n]) votes[categories[current]][n]=0;
      const btn = document.createElement("button");
      btn.textContent = n;
      btn.onclick = (e)=>vote(categories[current],n,e);
      options.appendChild(btn);
    });
  }

  function vote(cat,name,e) {
    votes[cat][name]++;
    localStorage.setItem("votes2077",JSON.stringify(votes));

    // ضحك عشوائي
    const laughs=["laugh1","laugh2","laugh3"];
    document.getElementById(laughs[Math.floor(Math.random()*laughs.length)]).play();

    // Emoji طايرة
    const emojiList=["😂","🤣","😜","😹","😅"];
    const emoji=document.createElement("div");
    emoji.className="emoji-fly";
    emoji.textContent=emojiList[Math.floor(Math.random()*emojiList.length)];
    e.target.appendChild(emoji);
    setTimeout(()=>emoji.remove(),1000);
  }

  function nextQuestion() {
    current++;
    renderQuestion();
  }
  function prevQuestion() {
    if(current>0) current--;
    renderQuestion();
  }
  function randomVote() {
    const randName = names[Math.floor(Math.random()*names.length)];
    vote(categories[current],randName,{target:document.querySelector("#options button")});
  }

  function showLeaderboard() {
    document.getElementById("questionCard").style.display="none";
    document.getElementById("leaderboard").style.display="block";
    const resultsDiv=document.getElementById("results");
    resultsDiv.innerHTML="";
    let scores={};
    categories.forEach(cat=>{
      for(let n in votes[cat]) {
        if(!scores[n]) scores[n]=0;
        scores[n]+=votes[cat][n];
      }
    });
    const sorted=Object.entries(scores).sort((a,b)=>b[1]-a[1]);
    sorted.forEach((s,i)=>{
      const bar=document.createElement("div");
      bar.className="progress";
      const fill=document.createElement("div");
      fill.className="progress-fill";
      let percent=Math.round((s[1]/(categories.length*names.length))*100);
      fill.style.width=percent+"%";
      fill.textContent=`${s[0]} : ${s[1]} صوت (${percent}%)`;
      if(i===0) fill.style.background="gold";
      else if(i===1) fill.style.background="silver";
      else if(i===2) fill.style.background="#cd7f32";
      else fill.style.background="#1877f2";
      bar.appendChild(fill);
      resultsDiv.appendChild(bar);
    });
  }

  renderQuestion();
</script>

</body>
</html>
