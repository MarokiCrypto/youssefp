<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>InstaPlay 🎮</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body{margin:0;font-family:"Tajawal",sans-serif;
      background:linear-gradient(-45deg,#f9ce34,#ee2a7b,#6228d7,#f9ce34);
      background-size:400% 400%;animation:gradientMove 12s ease infinite;
      color:white;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;}
    @keyframes gradientMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    .card{background:rgba(0,0,0,0.55);backdrop-filter:blur(10px);
      padding:20px;border-radius:18px;width:100%;max-width:420px;
      box-shadow:0 12px 35px rgba(0,0,0,0.6);margin:10px auto;
      animation:fadeIn .6s ease;}
    h1,h2,h3{margin:0 0 15px;text-align:center;}
    input,button,select{width:100%;margin:6px 0;padding:12px;border:none;border-radius:10px;font-size:15px;}
    input,select{background:#fff;color:#333}
    button{cursor:pointer;font-weight:bold;background:linear-gradient(45deg,#ff416c,#ff4b2b);color:white;transition:.3s;box-shadow:0 4px 12px rgba(0,0,0,0.3);}
    button:hover{transform:scale(1.07) translateY(-2px);box-shadow:0 6px 18px rgba(0,0,0,0.5);}
    .hidden{display:none}
    .games-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}
    .game-btn{background:linear-gradient(45deg,#36d1dc,#5b86e5);color:#fff;padding:14px;border-radius:12px;font-weight:bold;cursor:pointer;transition:.3s;box-shadow:0 4px 12px rgba(0,0,0,0.3);}
    .game-btn:hover{transform:scale(1.08);box-shadow:0 0 15px rgba(255,255,255,0.6);}
    table{width:100%;border-collapse:collapse;background:rgba(255,255,255,0.1);margin-top:10px;}
    th,td{padding:6px;border:1px solid rgba(255,255,255,0.2);font-size:13px;text-align:center}
    th{background:rgba(0,0,0,0.4)}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
    #confettiCanvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:999;}
    .result{margin-top:12px;font-size:18px;font-weight:bold;animation:fadeIn .5s ease;}
    .win{color:#4caf50;animation:pop .4s ease;}
    .lose{color:#f44336;animation:shake .5s;}
    @keyframes pop{0%{transform:scale(0.8);}50%{transform:scale(1.2);}100%{transform:scale(1);}}
    @keyframes shake{0%{transform:translateX(-5px);}25%{transform:translateX(5px);}50%{transform:translateX(-5px);}75%{transform:translateX(5px);}100%{transform:translateX(0);}}
  </style>
</head>
<body>
<canvas id="confettiCanvas" class="hidden"></canvas>

<!-- 🔐 Auth -->
<div id="auth" class="card">
  <h1>🎮 InstaPlay</h1>
  <h3>Login / Register</h3>
  <input id="name" type="text" placeholder="Full name">
  <input id="email" type="text" placeholder="Email">
  <input id="pass" type="password" placeholder="Password">
  <button onclick="register()">Register</button>
  <button onclick="login()">Login</button>
  <button onclick="show('adminLogin')">👑 Admin Login</button>
</div>

<!-- 👑 Admin Login -->
<div id="adminLogin" class="card hidden">
  <h2>👑 Admin Login</h2>
  <input id="adminEmail" type="text" placeholder="Email">
  <input id="adminPass" type="password" placeholder="Password">
  <button onclick="adminLogin()">Login</button>
  <button onclick="backToAuth()">⬅️ Back</button>
</div>

<!-- 👑 Admin Panel -->
<div id="adminPanel" class="card hidden">
  <h2>👑 Admin Panel</h2>
  <input id="searchId" type="text" placeholder="Search by ID">
  <button onclick="searchUserById()">🔍 Search</button>
  <div id="searchResult" style="margin:8px 0;font-size:14px"></div>
  <table id="usersTable">
    <thead>
      <tr><th>Name</th><th>ID</th><th>Balance</th><th>Edit Balance</th><th>Mode</th></tr>
    </thead>
    <tbody></tbody>
  </table>
  <button onclick="backToAuth()">⬅️ Logout</button>
</div>

<!-- 🎮 Dashboard -->
<div id="dashboard" class="card hidden">
  <h2>Welcome <span id="userName"></span></h2>
  <p>ID: <span id="userId"></span></p>
  <p>💰 Balance: <span id="balance"></span> $</p>
  <select id="betAmount"><option value="5">5$</option><option value="10">10$</option><option value="20">20$</option><option value="50">50$</option></select>
  <div class="games-grid">
    <div class="game-btn" onclick="hideAll();show('coinGame')">🪙 Coin</div>
    <div class="game-btn" onclick="hideAll();show('diceGame')">🎲 Dice</div>
    <div class="game-btn" onclick="hideAll();show('rpsGame')">✊✋✌️ RPS</div>
    <div class="game-btn" onclick="hideAll();show('slotGame')">🎰 Slot</div>
    <div class="game-btn" onclick="startMines()">💣 Mines</div>
  </div>
  <button onclick="hideAll();show('bankCard')">🏦 Deposit / Withdraw</button>
  <button onclick="show('historyCard');renderHistory()">📜 Transactions</button>
  <button onclick="logout()">🚪 Logout</button>
</div>

<!-- 📜 Transactions -->
<div id="historyCard" class="card hidden">
  <h2>📜 Transactions</h2>
  <table id="historyTable"><thead><tr><th>Type</th><th>Amount</th><th>Date</th></tr></thead><tbody></tbody></table>
  <button onclick="backToDash()">⬅️ Back</button>
</div>

<!-- 🏦 Banks -->
<div id="bankCard" class="card hidden">
  <h2>🏦 Deposit / Withdraw</h2>
  <ul style="list-style:none;padding:0;text-align:center">
    <li>💳 Cash Plus</li><li>🏦 CIH Bank</li><li>🏦 Al Barid Bank</li><li>🏦 Attijariwafa Bank</li>
  </ul>
  <p>📞 تواصل معنا عبر الواتساب:<br><b style="color:#0f0">+212 713-041921</b></p>
  <button onclick="backToDash()">⬅️ Back</button>
</div>

<!-- 🎮 Games -->
<div id="coinGame" class="card hidden"><h2>🪙 Coin Toss</h2><button onclick="flipCoin('Heads')">Heads</button><button onclick="flipCoin('Tails')">Tails</button><p id="coinResult" class="result"></p><button onclick="backToDash()">⬅️ Back</button></div>
<div id="diceGame" class="card hidden"><h2>🎲 Dice</h2><button onclick="rollDice()">🎲 Roll</button><p id="diceResult" class="result"></p><button onclick="backToDash()">⬅️ Back</button></div>
<div id="rpsGame" class="card hidden"><h2>✊✋✌️ RPS</h2><button onclick="playRPS('✊')">✊</button><button onclick="playRPS('✋')">✋</button><button onclick="playRPS('✌️')">✌️</button><p>انت: <span id="playerChoice"></span></p><p>الكمبيوتر: <span id="computerChoice"></span></p><p id="rpsResult" class="result"></p><button onclick="backToDash()">⬅️ Back</button></div>
<div id="slotGame" class="card hidden"><h2>🎰 Slot</h2><button onclick="playSlot()">▶️ Spin</button><p id="slotResult" class="result"></p><button onclick="backToDash()">⬅️ Back</button></div>
<div id="minesGame" class="card hidden"><h2>💣 Mines</h2><div id="minesGrid" style="display:grid;grid-template-columns:repeat(5,60px);gap:10px;justify-content:center;margin:15px 0;"></div><p id="minesResult" class="result"></p><button onclick="cashoutMines()">💵 Cashout</button><button onclick="resetMines()">🔄 Reset</button><button onclick="backToDash()">⬅️ Back</button></div>

<script>
/* Admin */
const ADMIN_EMAIL="special@gmail.com";const ADMIN_PASS="special123";let currentUser=null;
/* Sound */
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
function playTone(f,d,t="sine"){let o=audioCtx.createOscillator(),g=audioCtx.createGain();o.type=t;o.frequency.setValueAtTime(f,audioCtx.currentTime);o.connect(g);g.connect(audioCtx.destination);o.start();g.gain.exponentialRampToValueAtTime(0.0001,audioCtx.currentTime+d/1000);o.stop(audioCtx.currentTime+d/1000);}
function soundClick(){playTone(500,100,"square");}
function soundWin(){playTone(600,200,"sine");setTimeout(()=>playTone(800,200,"sine"),200);}
function soundLose(){playTone(400,300,"sawtooth");}
/* Confetti */
function launchConfetti(){let c=document.getElementById("confettiCanvas");c.classList.remove("hidden");let ctx=c.getContext("2d");c.width=window.innerWidth;c.height=window.innerHeight;let p=new Array(100).fill().map(()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*6+4,d:Math.random()*100,color:`hsl(${Math.random()*360},100%,50%)`,tilt:Math.random()*10-10}));function draw(){ctx.clearRect(0,0,c.width,c.height);p.forEach(x=>{ctx.beginPath();ctx.fillStyle=x.color;ctx.arc(x.x,x.y,x.r,0,Math.PI*2,false);ctx.fill();});update();}function update(){p.forEach(x=>{x.y+=Math.cos(x.d)+1+x.r/2;x.x+=Math.sin(x.d);if(x.y>c.height){x.x=Math.random()*c.width;x.y=-10;}});}let i=setInterval(draw,20);setTimeout(()=>{clearInterval(i);c.classList.add("hidden");},3000);}
/* Helpers */
function uid(){return "UID"+Math.floor(Math.random()*99999);}
function saveUser(u){localStorage.setItem("user_"+u.email,JSON.stringify(u));renderUsers();}
function loadUser(e){return JSON.parse(localStorage.getItem("user_"+e));}
function allUsers(){let a=[];for(let i=0;i<localStorage.length;i++){let k=localStorage.key(i);if(k.startsWith("user_"))a.push(JSON.parse(localStorage.getItem(k)));}return a;}
function hideAll(){document.querySelectorAll(".card").forEach(c=>c.classList.add("hidden"));}
function show(id){hideAll();document.getElementById(id).classList.remove("hidden");}
function backToDash(){hideAll();show("dashboard");}
function backToAuth(){hideAll();show("auth");}
/* Auth */
function register(){let n=document.getElementById("name").value,e=document.getElementById("email").value,p=document.getElementById("pass").value;if(!n||!e||!p){alert("Fill all fields");return;}if(loadUser(e)){alert("Account already exists");return;}let u={name:n,email:e,password:p,balance:20,id:uid(),mode:"normal"};saveUser(u);alert("Registered successfully (20$ bonus).");renderUsers();}
function login(){let e=document.getElementById("email").value,p=document.getElementById("pass").value;let u=loadUser(e);if(!u||u.password!==p){alert("Invalid credentials");return;}currentUser=u;updateUI();show("dashboard");}
function logout(){currentUser=null;backToAuth();}
function adminLogin(){let e=document.getElementById("adminEmail").value,p=document.getElementById("adminPass").value;if(e===ADMIN_EMAIL&&p===ADMIN_PASS){show("adminPanel");renderUsers();}else alert("❌ Wrong admin login");}
function updateUI(){document.getElementById("userName").innerText=currentUser.name;document.getElementById("userId").innerText=currentUser.id;document.getElementById("balance").innerText=currentUser.balance;saveUser(currentUser);}
function getBet(){let v=parseInt(document.getElementById("betAmount").value);if(currentUser.balance<v){alert("Not enough balance");return null;}return v;}
function forceResult(){return currentUser.mode||"normal";}
/* Admin Panel */
function renderUsers(){let t=document.querySelector("#usersTable tbody");t.innerHTML="";allUsers().forEach(u=>{let s=btoa(u.email);let tr=document.createElement("tr");tr.innerHTML=`<td>${u.name}</td><td>${u.id}</td><td>${u.balance}</td><td><input type='number' value='${u.balance}' id='bal_${s}'><button onclick="updateBal('${u.email}')">✔️</button></td><td><select id="mode_${s}" onchange="changeMode('${u.email}')"><option value="normal" ${u.mode==="normal"?"selected":""}>⚖️ Normal</option><option value="win" ${u.mode==="win"?"selected":""}>🔥 Always Win</option><option value="lose" ${u.mode==="lose"?"selected":""}>❌ Always Lose</option></select></td>`;t.appendChild(tr);});}
function updateBal(e){let s=btoa(e);let u=loadUser(e);u.balance=parseInt(document.getElementById("bal_"+s).value);saveUser(u);if(currentUser&&currentUser.email===e){currentUser=u;updateUI();}renderUsers();}
function changeMode(e){let s=btoa(e);let u=loadUser(e);u.mode=document.getElementById("mode_"+s).value;saveUser(u);if(currentUser&&currentUser.email===e){currentUser=u;}renderUsers();}
/* Search by ID */
function searchUserById(){let id=document.getElementById("searchId").value.trim();let u=allUsers().find(x=>x.id===id);let d=document.getElementById("searchResult");if(u){d.innerHTML=`<p>👤 <b>${u.name}</b><br>🆔 ${u.id}<br>💰 ${u.balance}$</p>`;}else{d.innerHTML="<p>❌ No user found</p>";}}
/* Games */
function flipCoin(c){let b=getBet();if(!b)return;soundClick();let m=forceResult(),r;if(m==="win"){r=c;}else if(m==="lose"){r=(c==="Heads"?"Tails":"Heads");}else{r=Math.random()<0.5?"Heads":"Tails";}setTimeout(()=>{if(r===c){currentUser.balance+=b;document.getElementById("coinResult").innerText="🎉 Win +"+b;document.getElementById("coinResult").className="result win";soundWin();launchConfetti();addHistory("Win",b);}else{currentUser.balance-=b;document.getElementById("coinResult").innerText="❌ Lose -"+b;document.getElementById("coinResult").className="result lose";soundLose();addHistory("Lose",b);}updateUI();},800);}
function rollDice(){let b=getBet();if(!b)return;soundClick();let m=forceResult(),r;if(m==="win"){r=6;}else if(m==="lose"){r=1;}else{r=Math.floor(Math.random()*6)+1;}let f=["⚀","⚁","⚂","⚃","⚄","⚅"];setTimeout(()=>{if(r>=4){currentUser.balance+=b;document.getElementById("diceResult").innerText=`${f[r-1]} 🎉 Win +${b}`;document.getElementById("diceResult").className="result win";soundWin();launchConfetti();addHistory("Win",b);}else{currentUser.balance-=b;document.getElementById("diceResult").innerText=`${f[r-1]} ❌ Lose -${b}`;document.getElementById("diceResult").className="result lose";soundLose();addHistory("Lose",b);}updateUI();},800);}
function playRPS(p){let b=getBet();if(!b)return;soundClick();let m=forceResult(),o=["✊","✋","✌️"],c;if(m==="win"){c=(p==="✊"?"✌️":p==="✋"?"✊":"✋");}else if(m==="lose"){c=(p==="✊"?"✋":p==="✋"?"✌️":"✊");}else{c=o[Math.floor(Math.random()*3)];}document.getElementById("playerChoice").innerText=p;document.getElementById("computerChoice").innerText=c;let res="";if(p===c){res="🤝 Draw";addHistory("Draw",0);}else if((p==="✊"&&c==="✌️")||(p==="✋"&&c==="✊")||(p==="✌️"&&c==="✋")){currentUser.balance+=b;res="🎉 Win +"+b;soundWin();launchConfetti();addHistory("Win",b);}else{currentUser.balance-=b;res="❌ Lose -"+b;soundLose();addHistory("Lose",b);}document.getElementById("rpsResult").innerText=res;updateUI();}
function playSlot(){let b=getBet();if(!b)return;soundClick();let m=forceResult(),s=["🍒","🍋","⭐","🔔","7️⃣"],r;if(m==="win"){r=["7️⃣","7️⃣","7️⃣"];}else if(m==="lose"){r=["🍒","⭐","🔔"];}else{r=[s[Math.floor(Math.random()*s.length)],s[Math.floor(Math.random()*s.length)],s[Math.floor(Math.random()*s.length)]];}let msg="";if(r[0]===r[1]&&r[1]===r[2]){currentUser.balance+=b*5;msg="🎉 Jackpot!! +"+(b*5);soundWin();launchConfetti();addHistory("Jackpot",b*5);}else if(r[0]===r[1]||r[1]===r[2]||r[0]===r[2]){currentUser.balance+=b;msg="✨ Small Win +"+b;soundWin();launchConfetti();addHistory("Win",b);}else{currentUser.balance-=b;msg="❌ Lose -"+b;soundLose();addHistory("Lose",b);}document.getElementById("slotResult").innerText=r.join(" ")+" → "+msg;updateUI();}
let minesData=[],minesActive=false,minesBet=0;
function startMines(){hideAll();show("minesGame");resetMines();}
function resetMines(){let g=document.getElementById("minesGrid");g.innerHTML="";minesData=[];minesActive=true;minesBet=getBet();if(!minesBet)return;for(let i=0;i<25;i++){let m=Math.random()<0.2;minesData.push(m);let b=document.createElement("button");b.innerText="❓";b.style.width="60px";b.style.height="60px";b.style.fontSize="22px";b.onclick=()=>clickMine(i,b);g.appendChild(b);}}
function clickMine(i,btn){if(!minesActive)return;soundClick();if(minesData[i]){btn.innerText="💣";btn.style.background="#ff4444";currentUser.balance-=minesBet;minesActive=false;document.getElementById("minesResult").innerText="❌ Boom! -"+minesBet;document.getElementById("minesResult").className="result lose";soundLose();addHistory("Lose",minesBet);}else{btn.innerText="💎";btn.style.background="#44ff44";currentUser.balance+=minesBet;document.getElementById("minesResult").innerText="🎉 Safe! +"+minesBet;document.getElementById("minesResult").className="result win";soundWin();launchConfetti();addHistory("Win",minesBet);}updateUI();}
function cashoutMines(){if(minesActive){minesActive=false;document.getElementById("minesResult").innerText+=" 💵 Cashed Out";}}
/* History */
function addHistory(t,a){let h=JSON.parse(localStorage.getItem("history_"+currentUser.email)||"[]");h.push({type:t,amount:a,date:new Date().toLocaleString()});localStorage.setItem("history_"+currentUser.email,JSON.stringify(h));}
function renderHistory(){let tbody=document.querySelector("#historyTable tbody");tbody.innerHTML="";let h=JSON.parse(localStorage.getItem("history_"+currentUser.email)||"[]");h.forEach(op=>{let tr=document.createElement("tr");tr.innerHTML=`<td>${op.type}</td><td>${op.amount}$</td><td>${op.date}</td>`;tbody.appendChild(tr);});}
</script>
</body>
</html>
